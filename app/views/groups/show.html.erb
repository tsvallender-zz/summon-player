<% provide(:title, @group.name) %>
<h2><%= @group.name %></h2>
<% if @group.user == current_user %>
    <%= link_to 'Edit group', edit_group_path(@group) %>
<% end %>
<ul>
    <li>Owned by <%= link_to @group.user.username, user_path(@group.user) %>.</li>
</ul>

<turbo-frame id="join-group">
    <% if @group.members.include?(current_user) && @group.user != current_user %>
        <% message = "Are you sure you want to leave "+ @group.name + "?" %>
        <%= link_to "Leave group",
            @groupuser,
            method: :delete,
            data: { confirm: message } %>
    <% elsif !@group.members.include?(current_user) %>
        <% case @group.privacy
           when 'open' %>
            <% button_text = 'Join ' + @group.name %>
        <% when 'request' %>
            <% button_text = 'Request to join ' + @group.name %>
        <% end %>
        <% unless @group.privacy == 'invite' %>
            <%= form_with(model: @groupuser, id: "joinForm") do |f| %>
                <%= render 'shared/error_messages', object: f.object %>
                <%= f.hidden_field :user_id, value: current_user.id %>
                <%= f.hidden_field :group_id, value: @group.id %>
                <%= f.submit button_text %>
            <% end %>
        <% end %>
    <% end %>
</turbo-frame>